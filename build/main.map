{"version":3,"sources":["webpack:///webpack/bootstrap c1f598381eae481625e7","webpack:///external \"koa-router\"","webpack:///external \"jwt-koa\"","webpack:///external \"mongoose\"","webpack:///./src/index.js","webpack:///external \"koa\"","webpack:///./src/router/index.js","webpack:///external \"koa-combine-routers\"","webpack:///./src/router/root.js","webpack:///./src/router/auth.js","webpack:///external \"koa-bodyparser\"","webpack:///./src/db/methods.js","webpack:///./src/models/user.js","webpack:///external \"bluebird\"","webpack:///external \"bcrypt-nodejs\"","webpack:///./src/utils/start.js","webpack:///./src/db/index.js"],"names":["require","config","app","start","use","router","combine","root","get","jwtKoa","middleware","ctx","body","auth","post","koaBody","login","request","then","res","response","register","check","details","User","findOne","data","username","email","res2","user","name","age","gender","image","salt","bcrypt","genSaltSync","password","hashSync","save","token","createToken","success","message","passCheck","compareSync","mongoose","Promise","UserSchema","type","String","required","index","unique","Number","model","PORT","HOST","process","env","startDb","listen","console","log","DB_USER","DB_USER_PASS","DB_HOST","DB_PORT","DB_NAME","connect"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c1f598381eae481625e7","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"jwt-koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jwt-koa\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 2\n// module chunks = 0","// @flow\r\nimport Koa from 'koa';\r\nimport router from './router';\r\nimport start from './utils/start';\r\nif (process.env.NODE_ENV !== 'production') require('dotenv').config();\r\n\r\nconst app = new Koa();\r\n\r\nstart(app);\r\napp.use(router);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 5\n// module chunks = 0","import combine from 'koa-combine-routers';\r\nimport root from './root';\r\nimport auth from './auth';\r\n\r\nconst router = combine([root, auth]);\r\n\r\nexport default router;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","module.exports = require(\"koa-combine-routers\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-combine-routers\"\n// module id = 7\n// module chunks = 0","import Router from 'koa-router';\r\nimport jwtKoa from 'jwt-koa';\r\n\r\nconst root = new Router();\r\n\r\nroot.get('/check', jwtKoa.middleware, (ctx) => {\r\n    ctx.body = '<h1>SECRET...</h1>';\r\n});\r\nroot.get('/', async (ctx) => {\r\n    ctx.body = ` <h1>Working...</h1>`;\r\n});\r\n\r\nexport default root;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/root.js","import Router from 'koa-router';\r\nimport koaBody from 'koa-bodyparser';\r\nimport { register, login } from '../db/methods';\r\n\r\nconst auth = new Router();\r\nauth.post('/login', koaBody(), async (ctx) => {\r\n    await login(ctx.request.body).then((res) => {\r\n        ctx.response.body = res;\r\n    });\r\n});\r\n\r\nauth.post('/register', koaBody(), async (ctx) => {\r\n    await register(ctx.request.body).then((res) => {\r\n        ctx.response.body = res;\r\n    });\r\n});\r\n\r\nexport default auth;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/auth.js","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 10\n// module chunks = 0","// @flow\r\nimport type { UserType } from '../types.flow';\r\nimport User from '../models/user';\r\nimport bcrypt from 'bcrypt-nodejs';\r\nimport { createToken } from 'jwt-koa';\r\n\r\nexport async function check(details) {\r\n    return User.findOne(details);\r\n}\r\n\r\nexport async function register(data: UserType) {\r\n    return check({ username: data.username }).then((res) => {\r\n        if (res === null) {\r\n            return check({ email: data.email }).then(async (res2) => {\r\n                if (res2 === null) {\r\n                    const user = await new User({\r\n                        username: data.username,\r\n                        name: data.name,\r\n                        age: data.age,\r\n                        email: data.email,\r\n                        gender: data.gender,\r\n                        image: data.image,\r\n                    });\r\n                    const salt: string = bcrypt.genSaltSync(10);\r\n                    user.password = bcrypt.hashSync(data.password, salt);\r\n                    return user.save().then((user) => {\r\n                        const token = createToken({ user }, '10m');\r\n                        return { success: true, user, token };\r\n                    });\r\n                } else {\r\n                    return { success: false, message: 'Email registred!' };\r\n                }\r\n            });\r\n        } else {\r\n            return { success: false, message: 'Username taken!' };\r\n        }\r\n    });\r\n}\r\n\r\nexport async function login(data: { username: string, password: string }) {\r\n    return check({ username: data.username }).then((user) => {\r\n        if (user === null) {\r\n            return { success: false, message: 'User not found!' };\r\n        } else {\r\n            const passCheck = bcrypt.compareSync(data.password, user.password);\r\n            if (passCheck === true) {\r\n                const token = createToken({ user }, '10m');\r\n                return { success: true, user, token };\r\n            } else {\r\n                return { success: false, message: 'Wrong password!' };\r\n            }\r\n        }\r\n    });\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/db/methods.js","import mongoose, { Schema } from 'mongoose';\r\nimport bluebird from 'bluebird';\r\n\r\nmongoose.Promise = bluebird;\r\n\r\nconst UserSchema = new Schema({\r\n    username: { type: String, required: true, index: { unique: true } },\r\n    name: { type: String },\r\n    gender: { type: String, required: true },\r\n    image: { type: String },\r\n    age: { type: Number, required: true },\r\n    email: { type: String },\r\n    password: { type: String }, // social auth will not have password\r\n});\r\n\r\nconst user = mongoose.model('User', UserSchema);\r\n\r\nexport default user;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.js","module.exports = require(\"bluebird\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bluebird\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"bcrypt-nodejs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt-nodejs\"\n// module id = 14\n// module chunks = 0","if (process.env.NODE_ENV !== 'production') require('dotenv').config();\r\nimport startDb from '../db/';\r\n\r\nconst { PORT, HOST } = process.env;\r\n\r\nexport default function(app) {\r\n    startDb();\r\n    app.listen(PORT || 8000, () =>\r\n        console.log(`started in http://${HOST}:${PORT}`)\r\n    );\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/start.js","if (process.env.NODE_ENV !== 'production') require('dotenv').config();\r\nimport mongoose from 'mongoose';\r\n\r\nconst { DB_USER, DB_USER_PASS, DB_HOST, DB_PORT, DB_NAME } = process.env;\r\n\r\nexport default function() {\r\n    mongoose.connect(\r\n        `mongodb://${DB_USER}:${DB_USER_PASS}@${DB_HOST}:${DB_PORT}/${DB_NAME}`\r\n    );\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/db/index.js"],"sourceRoot":""}